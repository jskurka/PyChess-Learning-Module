#!/usr/bin/python
#
# PyChess startup script
#

import os, sys
import pygtk
pygtk.require("2.0")

# Import datalocation functions and ensure access to codebase
try:
    from pychess.System.prefix import addDataPrefix, getDataPrefix, isInstalled
except ImportError:
    print "ERROR: Could not import modules."
    print "Please try to run pychess as stated in the INSTALL file"
    sys.exit(1)

# Start logging
from pychess.System.Log import log
log.debug("Started")

# Set up translations
import gettext, gtk.glade
if isInstalled():
    gettext.install("pychess", unicode=1)
    gtk.glade.bindtextdomain("pychess")
else:
    gettext.install("pychess", localedir=addDataPrefix("lang"), unicode=1)
    gtk.glade.bindtextdomain("pychess", addDataPrefix("lang"))
gtk.glade.textdomain("pychess")

# This is an ugly hack needed prior to gtkSourceView2 because of a pygtk bug:
# http://bugzilla.gnome.org/show_bug.cgi?id=393483
os.environ["XDG_DATA_DIRS"] = getDataPrefix()+":/usr/share/"

# Let's rumble!
import pychess.Main
pychess.Main.run(sys.argv[1:])
